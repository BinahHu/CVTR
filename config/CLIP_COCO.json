{
    "name": "CLIP_COCO_seq_current_optimal",
    "n_gpu": 2,
    "arch": {
        "type": "CLIPModel",
        "args": {
            "pretrained_model_name": "ViT-B/16",
            "image_prompts_per_task": 1,
            "text_prompts_per_task": 1,
            "embd_dim": 768,
            "prompt_strategy": "mean_per_task",
            "clip_strategy": "cls_token",
            "prompt_init": "cls_token"
        }
    },
    "memory": {
        "size": 0,
        "memory_strategy": "random"
    },
    "data_loader": {
        "type": "ContinualLoader",
        "args":{
            "batch_size": 32,
            "shuffle": true,
            "num_workers": 8
        }
    },
    "dataset": {
        "type": "ContinualCOCODataset",
        "args": {
            "few_shot": -1,
            "dataset_root_dir": "/home/CVTR/COCO/",
            "random_split": false

        }
    },
    "continual": {
        "task_num": 10,
        "group_idx": [0,0,0,0,0,0,0,0,0,0],
        "decouple": false,
        "decouple_group_index": 1

    },
    "optimizer": [{
        "type": "AdamW",
        "args":{
            "lr": 0.0001,
            "weight_decay": 0.00001,
            "amsgrad": true
        }
    },{
        "type": "AdamW",
        "args":{
            "lr": 0.0001,
            "weight_decay": 0.00001,
            "amsgrad": true
        }
    }],
    "loss": "visual_text_contrastive_loss",
    "metrics": [
        "visualtext_retrieval_accuracy"
    ],
    "lr_scheduler": [{
        "type": "MultiStepLR",
        "args":{
            "milestones": [10, 20]
        }
    }, {
        "type": "None"
    }],
    "trainer": {
        "group_args": [{
                "epochs": 30
            },
            {
                "epochs": 10
            }
        ],
        "save_dir": "/mnt/log/ckpt/CVTR",
        "save_period": 30,
        "verbosity": 2,
        "monitor": "off",
        "val_step": 10,
        "tensorboard": false
  }
}