{
    "name": "Vit_CIFAR100_Cls_aux_mem5000_fromCLIP",
    "n_gpu": 2,
    "arch": {
        "type": "VitModel",
        "args": {
            "pretrained_model_name": "CLIP-ViT-B/16",
            "prompts_per_task": 1,
            "pop_num": 1,
            "embd_dim": 768,
            "prompt_cls_strategy": "mean_per_task_aux"
        }
    },
    "memory": {
        "size": 5000,
        "memory_strategy": "icarl"
    },
    "data_loader": {
        "type": "ContinualLoader",
        "args":{
            "batch_size": 64,
            "shuffle": true,
            "validation_split": 0,
            "num_workers": 8
        }
    },
    "dataset": {
        "type": "ContinualCIFAR100Dataset",
        "args": {
            "few_shot": -1,
            "meta_root_dir": "",
            "dataset_root_dir": "/mnt/datasets/CIFAR100/",
            "task_split": [[87, 0, 52, 58, 44, 91, 68, 97, 51, 15],
                            [94, 92, 10, 72, 49, 78, 61, 14, 8, 86],
                            [84, 96, 18, 24, 32, 45, 88, 11, 4, 67],
                            [69, 66, 77, 47, 79, 93, 29, 50, 57, 83],
                            [17, 81, 41, 12, 37, 59, 25, 20, 80, 73],
                            [1, 28, 6, 46, 62, 82, 53, 9, 31, 75],
                            [38, 63, 33, 74, 27, 22, 36, 3, 16, 21],
                            [60, 19, 70, 90, 89, 43, 5, 42, 65, 76],
                            [40, 30, 23, 85, 2, 95, 56, 48, 71, 64],
                            [98, 13, 99, 7, 34, 55, 54, 26, 35, 39]]

        }
    },
    "continual": {
        "task_num": 10,
        "group_idx": [0,0,0,0,0,0,0,0,0,0],
        "decouple": true,
        "decouple_group_index": 1

    },
    "optimizer": [{
        "type": "AdamW",
        "args":{
            "lr": 0.0005,
            "weight_decay": 0.000001,
            "amsgrad": true
        }
    },{
        "type": "AdamW",
        "args":{
            "lr": 0.0005,
            "weight_decay": 0.000001,
            "amsgrad": true
        }
    }],
    "loss": "bce_with_task_loss",
    "metrics": [
        "img_cls_accuracy"
    ],
    "lr_scheduler": [{
        "type": "MultiStepLR",
        "args":{
            "milestones": [60, 100, 120]
        }
    }, {
        "type": "None"
    }],
    "trainer": {
        "group_args": [{
                "epochs": 170
            },
            {
                "epochs": 20
            }
        ],
        "save_dir": "/mnt/log/ckpt/POP",
        "save_period": 30,
        "verbosity": 2,
        "monitor": "off",
        "val_step": 10,
        "tensorboard": false
  }
}